import React, { useState } from 'react';
import { View, Button, Image } from 'react-native';
import { pickImage, takePhoto, savePhoto, addItemWithPhoto } from './helpers';

const AddAsset = () => {
  const [imageUri, setImageUri] = useState(null);

  const handlePickImage = async () => {
    const uri = await pickImage();
    if (uri) {
      const savedUri = await savePhoto(uri);
      setImageUri(savedUri);
    }
  };

  const handleTakePhoto = async () => {
    const uri = await takePhoto();
    if (uri) {
      const savedUri = await savePhoto(uri);
      setImageUri(savedUri);
    }
  };

  const handleSaveAsset = () => {
    const name = "Asset Name";
    const description = "Asset Description";
    const barcode = 123456;
    const price = 100.0;
    const dateCreated = new Date().toISOString();
    const person = "John Doe";
    const location = "New York";

    addItemWithPhoto(name, description, barcode, price, dateCreated, person, location, imageUri, (result) => {
      console.log('Asset saved:', result);
    });
  };

  return (
    <View>
      <Button title="Pick Image" onPress={handlePickImage} />
      <Button title="Take Photo" onPress={handleTakePhoto} />
      {imageUri && <Image source={{ uri: imageUri }} style={{ width: 200, height: 200 }} />}
      <Button title="Save Asset" onPress={handleSaveAsset} />
    </View>
  );
};

export default AddAsset;